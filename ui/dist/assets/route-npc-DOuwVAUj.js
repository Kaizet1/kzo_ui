import{d as ee,p as V,a as x,u as te,o as ae,f as w,e as G,$ as H,c as i,i as D,g as a,s as F,b as v,t as O,h as g,j as J,k as s,l as re,m as ne,n as _,q as ie,r as B,v as h,w as L,x as oe,y as le,z as se,A as de,B as ce,C as ve}from"./vendor-svelte-CKyFLlM8.js";var ue=w('<div class="absolute bottom-4 right-8 text-[0.7rem] text-[#7CFFFF]/60 tracking-[0.15em] uppercase font-bold flex items-center gap-2 z-10"><span class="animate-pulse">â–º</span> SPACE TO SKIP</div>'),fe=w('<div class="choice-row relative flex items-center"><button class="group relative flex items-center w-full bg-[#0a0e17]/95 border-2 border-[#7CFFFF]/30 p-0 cursor-pointer overflow-hidden backdrop-blur-md [clip-path:polygon(0_0,100%_0,97%_100%,0_100%)] hover:border-[#7CFFFF] hover:shadow-[0_0_1.5625rem_rgba(124,255,255,0.2)] transition-all duration-300"><div class="flex items-center justify-center w-14 self-stretch bg-[#7CFFFF]/10 border-r-2 border-[#7CFFFF]/30 transition-colors duration-300 z-10 group-hover:bg-[#7CFFFF] group-hover:border-[#7CFFFF]"><span class="text-lg font-black text-[#7CFFFF] group-hover:text-[#050a0f] transition-colors duration-300"></span></div> <span class="flex-1 text-lg font-bold text-slate-300 text-left py-5 px-6 transition-all duration-300 z-10 group-hover:text-white group-hover:pl-8"> </span> <div class="absolute inset-y-0 left-0 w-0 bg-[linear-gradient(90deg,rgba(124,255,255,0.25),transparent)] z-0 transition-all duration-500 group-hover:w-full"></div></button></div>'),pe=w('<div class="relative w-full max-w-[59.375rem] pt-6 z-10"><div class="flex flex-col gap-3"></div></div>'),_e=w('<div class="flex flex-col items-center w-full"><div class="relative w-full max-w-[59.375rem] bg-[linear-gradient(90deg,rgba(10,14,23,0.98)_0%,rgba(10,14,23,0.8)_60%,transparent_100%)] backdrop-blur-md border-l-4 border-[#7CFFFF] pt-10 pb-8 px-10 cursor-pointer [clip-path:polygon(0_0,95%_0,100%_20%,100%_100%,0_100%)] shadow-[-0.625rem_0_1.875rem_rgba(0,0,0,0.6)] z-20" role="button" tabindex="0"><div class="absolute -top-[0.0625rem] -left-[0.25rem] bg-[#7CFFFF] flex items-center py-1 pl-4 pr-6 [clip-path:polygon(0_0,100%_0,85%_100%,0%_100%)] shadow-[0_0_0.9375rem_rgba(124,255,255,0.4)]"><span class="w-1.5 h-1.5 bg-black mr-2.5 rotate-45"></span> <span class="text-sm font-black uppercase text-[#050a0f]"> </span></div> <div class="min-h-[3.5rem] max-w-[85%] relative z-10"><p class="text-xl leading-relaxed text-slate-200 m-0 font-medium drop-shadow-md"> </p></div> <!></div> <!></div>');function ge(m,t){V(t,!0);let y=x(t,"typewriterSpeed",3,25),u=F(""),o=F(!0),f=F(0),r=null;function c(){a(o)&&(r&&clearInterval(r),s(u,t.node.text,!0),s(f,t.node.text.length,!0),s(o,!1))}function C(e){r&&clearInterval(r),s(u,""),s(f,0),s(o,!0),r=setInterval(()=>{a(f)<e.length?(s(u,a(u)+e[a(f)]),re(f)):(r&&clearInterval(r),s(o,!1))},y())}te(()=>{const e=t.node.text;return C(e),()=>{r&&clearInterval(r)}});function k(e){if(a(o)){c();return}t.onChoiceSelect(e)}function K(e){const l=parseInt(e.key);if(!isNaN(l)&&l>=1&&l<=t.node.choices.length){k(l-1);return}(e.code==="Space"||e.code==="Enter")&&a(o)&&c()}ae(()=>{r&&clearInterval(r)});var z=_e();G("keydown",H,K);var p=i(z);p.__click=c,p.__keydown=()=>{};var S=i(p),A=v(i(S),2),d=i(A),n=v(S,2),I=i(n),N=i(I),T=v(n,2);{var b=e=>{var l=ue();g(e,l)};D(T,e=>{a(o)&&e(b)})}var E=v(p,2);{var P=e=>{var l=pe(),U=i(l);ne(U,21,()=>t.node.choices,ie,(W,X,j)=>{var q=fe(),R=i(q);R.__click=()=>k(j);var M=i(R),Y=i(M);Y.textContent=j+1;var Z=v(M,2),$=i(Z);O(()=>B($,a(X).label)),_(1,q,()=>h,()=>({x:20,duration:400,delay:j*100})),g(W,q)}),_(1,l,()=>L,()=>({duration:300})),g(e,l)};D(E,e=>{!a(o)&&t.node.choices.length>0&&e(P)})}O(()=>{B(d,t.npcName),B(N,a(u))}),g(m,z),J()}ee(["click","keydown"]);const Q=Symbol("runtime");function he(m){return oe(Q,m)}function me(){return le(Q)}var be=w('<div class="fixed inset-0 z-[100] pointer-events-none font-sans"><div class="absolute left-0 right-0 top-0 h-[5vh] bg-black pointer-events-none z-0"></div> <div class="absolute left-0 right-0 bottom-0 h-[5vh] bg-black pointer-events-none z-0"></div> <div class="absolute inset-0 pointer-events-none z-10 bg-[radial-gradient(ellipse_at_center,transparent_35%,rgba(0,0,0,0.55)_100%),linear-gradient(to_top,rgba(0,0,0,0.45)_0%,transparent_35%)]"></div> <div class="absolute bottom-[8vh] left-0 right-0 w-full pointer-events-auto flex flex-col items-center gap-6 px-8 box-border z-20"><div class="w-full max-w-[75rem] flex flex-col items-center"><!></div></div></div>');function Fe(m,t){V(t,!0);const{messenger:y}=me();let u=x(t,"npcName",3,"NPC"),o=x(t,"dialogue",19,()=>({})),f=x(t,"typewriterSpeed",3,25);x(t,"locale",19,()=>({}));let r=F("start"),c=ve(()=>o()[a(r)]??null),C=F(!1);function k(d){if(!a(c))return;const n=a(c).choices[d];if(n){if(n.next){s(r,n.next,!0);return}if(n.action){y.emit("iuh_npc:action",{action:n.action,event:n.event,command:n.command,args:n.args});return}}}function K(){y.emit("iuh_npc:close")}function z(d){d.key==="Escape"&&K()}se(()=>{requestAnimationFrame(()=>{s(C,!0)})});var p=de();G("keydown",H,z);var S=ce(p);{var A=d=>{var n=be(),I=i(n),N=v(I,2),T=v(N,2),b=v(T,2),E=i(b),P=i(E);ge(P,{get npcName(){return u()},get node(){return a(c)},get typewriterSpeed(){return f()},onChoiceSelect:k}),_(3,I,()=>h,()=>({y:-60,duration:500})),_(3,N,()=>h,()=>({y:60,duration:500})),_(3,T,()=>L,()=>({duration:400})),_(1,b,()=>h,()=>({y:40,duration:550,delay:150})),_(2,b,()=>h,()=>({y:20,duration:250})),g(d,n)};D(S,d=>{a(C)&&a(c)&&d(A)})}g(m,p),J()}export{Fe as _,he as s,me as u};
